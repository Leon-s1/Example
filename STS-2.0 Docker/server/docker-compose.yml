version: '3.8'
services:

  sts-client:   #фронтенд
    build: ../client
    ports:
      - '3002:80'
#    networks:
#      - net
    #depends_on:
     # - sts-db

  sts-db:   #база данных
    image: postgres:14.1-alpine
    restart: always
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: Vbkfhtgf131715
      POSTGRES_DB: STS
      POSTGRES_HOST: localhost
      POSTGRES_PORT: 5432

     # PGHOST: localhost
      #DB_HOST: localhost # Вместо sts-db localhost
      #DB_PORT: 5440
      #DB_USER: postgres
      #DB_PASSWORD: Vbkfhtgf131715
      #DB_NAME: STS
    ports:
      - '5440:5432'
#    volumes:
#      - sts-db:/var/lib/postgresql/data
#    networks:
#      - net

  sts-server:   #бэкенд
    build: .    # Указывает, где находится Dockerfile для этого сервиса
    environment:
#      *********************************
#      POSTGRES_USER: "postgres",
#      POSTGRES_PASSWORD: "Vbkfhtgf131715",
#      POSTGRES_DB: "STS",
#      POSTGRES_NAME: "postgres",
#      POSTGRES_HOST: "localhost",
#      POSTGRES_PORT: "5440",
#     ***********************************

#      ******************************
      DATABASE_USERNAME: postgres
      DATABASE_PASSWORD: Vbkfhtgf131715
      DATABASE_NAME: STS
#      DATABASE_HOST: localhost
      DATABASE_HOST: sts-db
#      DATABASE_PORT: 5440
#*********************************************
#      POSTGRES_USER: postgres
#      POSTGRES_PASSWORD: Vbkfhtgf131715
#      POSTGRES_DB: STS
#
#***********************************************
#      DB_HOST: localhost # Вместо sts-db localhost
#      DB_PORT: 5440
#      DB_USER: postgres
#      DB_PASSWORD: Vbkfhtgf131715
#      DB_NAME: STS
#************************************************
    depends_on:
      - sts-db
      - sts-client
    ports:
      - '3001:3001'
#    networks:
#      - net
    #volumes:
      #- server:/app

#  networks:
#    net:
#      driver: bridge

#  volumes:
#    sts-db:

